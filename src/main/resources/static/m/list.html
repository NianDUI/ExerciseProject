<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>书籍</title>
    <!-- 定制版 ionic 样式 -->
    <link href="https://unpkg.com/vonic@2.0.0-beta.11/dist/vonic.min.css" rel="stylesheet">
    <!-- 依赖库 axios/vue/vue-router -->
    <script src="https://unpkg.com/axios@0.15.3/dist/axios.min.js"></script>
    <script src="https://unpkg.com/vue@2.1.10/dist/vue.min.js"></script>
    <script src="https://unpkg.com/vue-router@2.2.1/dist/vue-router.min.js"></script>
    <!-- vonic 核心文件 -->
    <script src="https://unpkg.com/vonic@2.0.0-beta.11/dist/vonic.min.js"></script>
</head>
<body>
<von-app></von-app>

<script>
    // 获取token
    function getToken() {
        let token = sessionStorage.getItem("token");
        if (token == null || token.length === 0) {
            do {
                token = prompt("请输入：");
            } while (token.trim().length === 0)
            sessionStorage.setItem("token", token);
        }
        return token;
    }

    const Index = {
        template: `
<div class="page has-navbar" v-nav="{ title: '书籍' }">
  <div class="page-content">
    <div class="padding light-bg">
    <div class="entrance assertive">
    <von-input type="text" v-model="prams.name" placeholder="请输入名称"></von-input>
    </div>
    <div class="entrance energized">
    <md-button class="button button-positive" @click.native="queryBookList()">搜索</md-button>
</div>
    </div>
    <list class="list-android">
      <item v-for="i in data.list" :key="i.bookid">
        <router-link to="/about/" v-text="i.name"></router-link>
      </item>
    </list>
  </div>
</div> `
        , data() {
            return {
                msg: 'Hello! Vonic.'
                , prams: {
                    name: ""
                    , pageNum: 1
                    , pageSize: 10
                }
                , data: {
                    total: 0
                    , list: [{bookid: 0, name: ""}]
                    , hasPreviousPage: false
                    , hasNextPage: false
                }
            }
        }
        , mounted() {
            // 生命周期方法
            this.queryBookList();
        }
        , methods: {
            queryBookList() {
                const o = this;
                axios({
                    method: 'post'
                    , headers: {"Content-Type": "application/json", "Token": getToken()}
                    , url: '/api/queryBookList'
                    , data: JSON.stringify(this.prams)
                }).then(function (response) {
                    o.data = response.data.data;
                });
            }
        }
    }

    const About = {
        template: `
    <div class="page has-navbar" v-nav="{ title: 'About', showBackButton: true }">
      <div class="page-content text-center">
        <h2 class="padding">Nothing here.</h2>
      </div>
    </div>
  `
    }

    const routes = [
        {path: '/', component: Index},
        {path: '/about', component: About}
    ]
    Vue.use(Vonic.app, {
        routes: routes
    })
</script>
</body>
</html>